(this.webpackJsonppuhelinluettelo=this.webpackJsonppuhelinluettelo||[]).push([[0],{41:function(e,n,t){},42:function(e,n,t){"use strict";t.r(n);var c=t(1),r=t(17),o=t.n(r),a=t(8),u=t(3),s=t(0),i=function(e){var n=e.persons.filter((function(n){return n.name.toLowerCase().includes(e.filter.toLowerCase())||void 0!==n.number&&n.number.includes(e.filter)}));return Object(s.jsx)("ul",{children:n.map((function(n){return Object(s.jsxs)("li",{children:[n.name," ",n.number,Object(s.jsx)("button",{onClick:function(){return e.deletePerson(n)},children:"Delete"})]},n.id)}))})},l=function(e){return Object(s.jsxs)("div",{children:["search ",Object(s.jsx)("input",{value:e.searchBar,onChange:function(n){return e.setSearchBar(n.target.value)}})]})},d=function(e){return Object(s.jsx)("div",{children:Object(s.jsxs)("form",{onSubmit:function(n){n.preventDefault(),e.addPersons()},children:[Object(s.jsxs)("div",{children:["name: ",Object(s.jsx)("input",{value:e.newName,onChange:function(n){console.log(n.target.value),e.setName(n.target.value)}})]}),Object(s.jsxs)("div",{children:["number: ",Object(s.jsx)("input",{value:e.newNumber,onChange:function(n){e.setNewNumber(n.target.value)}})]}),Object(s.jsx)("div",{children:Object(s.jsx)("button",{type:"submit",children:"add"})})]})})},f=t(4),j=t.n(f),b="/api/persons",h=function(){return j.a.get(b).then((function(e){return e.data}))},m=function(e){return j.a.post(b,e).then((function(e){return e.data}))},O=function(e,n){return j.a.put("".concat(b,"/").concat(e),n).then((function(e){return e.data}))},p=function(e){var n="http://localhost:3001/api/persons/".concat(e);return j.a.delete(n).then((function(e){return e.data}))},v=function(e){return null===e.message?null:Object(s.jsx)("div",{className:e.message.classText,children:e.message.text})},g=function(){var e=Object(c.useState)([]),n=Object(u.a)(e,2),t=n[0],r=n[1],o=Object(c.useState)(""),f=Object(u.a)(o,2),j=f[0],b=f[1],g=Object(c.useState)(""),x=Object(u.a)(g,2),w=x[0],N=x[1],S=Object(c.useState)(""),C=Object(u.a)(S,2),k=C[0],y=C[1],B=Object(c.useState)(null),D=Object(u.a)(B,2),P=D[0],T=D[1];Object(c.useEffect)((function(){console.log("effect"),h().then((function(e){console.log("promise fulfilled"),r(e)}))}),[]);var A=function(e,n){var t={text:e,classText:n};console.log("Message",t),T(t),setTimeout((function(){T(null)}),5e3)},E=function(e){var n=e.person;console.log("Updating",{person:n});var c=Object(a.a)(Object(a.a)({},n),{},{number:w});O(n.id,c).then((function(e){r(t.map((function(t){return t.id!==n.id?t:e}))),J();var c="Updated ".concat(e.name);A(c,"message")})).catch((function(e){var t="".concat(n.name," was already deleted from the server.");A(t,"error")}))},J=function(){b(""),N("")};return Object(s.jsxs)("div",{children:[Object(s.jsx)("h2",{children:"Phonebook"}),Object(s.jsx)(v,{message:P}),Object(s.jsx)(l,{searchBar:k,setSearchBar:function(e){return y(e)}}),Object(s.jsx)("h2",{children:"Add a new contact"}),Object(s.jsx)(d,{persons:t,setName:function(e){return b(e)},setNewNumber:function(e){return N(e)},addPersons:function(){var e=t.some((function(e){return e.name===j}));if(e)if(window.confirm("".concat(j," is already added to phonebook. Do you want to update the number?"))){var n=t.find((function(e){return e.name===j}));E({person:n})}else J();else{var c=w.length>0;m({name:j,number:c?w:""}).then((function(e){console.log("successful post"),r(t.concat(e)),J();var n="Added ".concat(e.name);A(n,"message")}))}},newName:j,newNumber:w}),Object(s.jsx)("h2",{children:"Numbers"}),Object(s.jsx)(i,{persons:t,deletePerson:function(e){return function(e){console.log("".concat(e," needs to be deleted"));var n=t.find((function(n){return n.id===e})).name;window.confirm("Delete ".concat(n," ?"))&&p(e).then((function(c){console.log("deleted",c),r(t.filter((function(n){return n.id!==e})));var o="Deleted ".concat(n);A(o,"message")}))}(e.id)},filter:k})]})};t(41);o.a.render(Object(s.jsx)(g,{}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.1ae1a3f7.chunk.js.map